<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISPENA SMART 2026 - Digital Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.15.0/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.15.0/firebase-firestore-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --navy: #0f172a; --blue: #2563eb; --green: #10b981; --red: #f43f5e; --bg: #f8fafc; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); margin: 0; padding-bottom: 50px; }
        .header { background: var(--navy); color: white; padding: 25px 20px; text-align: center; border-bottom: 4px solid var(--blue); }
        .container { max-width: 1100px; margin: -20px auto 0; padding: 0 15px; }
        
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 25px; }
        .grid-input { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        input, select { padding: 12px; border: 1px solid #cbd5e1; border-radius: 8px; width: 100%; box-sizing: border-box; }
        .btn-save { background: var(--blue); color: white; border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; grid-column: span 2; margin-top: 10px; }
        
        .action-bar { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; justify-content: center; }
        .btn-action { padding: 12px 20px; border-radius: 8px; text-decoration: none; font-weight: bold; border: none; cursor: pointer; color: white; display: flex; align-items: center; gap: 8px; transition: 0.3s; }
        .btn-action:hover { transform: translateY(-2px); opacity: 0.9; }
        .bg-excel { background: var(--green); }
        .bg-print { background: var(--red); }

        .component-box { background: white; border-radius: 12px; margin-bottom: 30px; overflow: hidden; border: 1px solid #e2e8f0; }
        .comp-header { padding: 15px 20px; color: white; font-weight: bold; font-size: 1rem; }
        .h-mutu { background: #ef4444; } .h-proses { background: #f59e0b; } .h-guru { background: #8b5cf6; } .h-manaj { background: #0ea5e9; }
        
        table { width: 100%; border-collapse: collapse; }
        th { background: #f8fafc; padding: 12px; text-align: left; font-size: 0.8rem; border-bottom: 1px solid #e2e8f0; color: #64748b; }
        td { padding: 12px; border-bottom: 1px solid #f1f5f9; font-size: 0.9rem; }
        .btn-view { color: var(--blue); text-decoration: none; font-weight: bold; }

        /* Modal Panduan */
        #guideModal { display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); overflow: auto; padding: 20px; box-sizing: border-box; }
        .modal-content { background: white; margin: 20px auto; padding: 30px; max-width: 800px; border-radius: 15px; position: relative; }
        .guide-text h3 { border-bottom: 2px solid #eee; padding-bottom: 5px; margin-top: 20px; }
        .guide-text ul { padding-left: 20px; }
        .guide-text li { margin-bottom: 5px; color: #444; }

        @media (max-width: 600px) { .grid-input { grid-template-columns: 1fr; } .btn-save { grid-column: span 1; } }
        @media print { .no-print { display: none !important; } #guideModal { position: absolute; background: white; } }
    </style>
</head>
<body>

<div class="header">
    <h1 style="margin:0;"><i class="fas fa-layer-group"></i> DASHBOARD SISPENA 2026</h1>
    <p style="opacity: 0.8;">Manajemen & Kendali Persiapan Akreditasi Sekolah</p>
</div>

<div class="container">
    <div class="card">
        <h3 style="margin-top:0"><i class="fas fa-plus-circle"></i> Input Link Dokumen</h3>
        <div class="grid-input">
            <input type="text" id="docName" placeholder="Nama Dokumen (Cth: SK Pembagian Tugas)">
            <select id="docCategory">
                <option value="mutu-lulusan">1. Mutu Lulusan</option>
                <option value="proses-pembelajaran">2. Proses Pembelajaran</option>
                <option value="mutu-guru">3. Mutu Guru</option>
                <option value="manajemen-sekolah">4. Manajemen Sekolah</option>
            </select>
            <input type="text" id="docLink" placeholder="Paste Link Google Drive" style="grid-column: span 2;">
            <button class="btn-save" onclick="saveData()"><i class="fas fa-save"></i> SIMPAN DOKUMEN</button>
        </div>
    </div>

    <div class="action-bar">
        <button onclick="downloadExcel()" class="btn-action bg-excel"><i class="fas fa-file-excel"></i> DOWNLOAD REKAP EXCEL</button>
        <button onclick="openGuide()" class="btn-action bg-print"><i class="fas fa-file-pdf"></i> PANDUAN & CHECKLIST</button>
    </div>

    <div class="component-box"><div class="comp-header h-mutu">MUTU LULUSAN</div>
        <table id="table-mutu"><thead><tr><th>Nama Dokumen</th><th>Aksi</th></tr></thead><tbody id="body-mutu"></tbody></table>
    </div>
    <div class="component-box"><div class="comp-header h-proses">PROSES PEMBELAJARAN</div>
        <table id="table-proses"><thead><tr><th>Nama Dokumen</th><th>Aksi</th></tr></thead><tbody id="body-proses"></tbody></table>
    </div>
    <div class="component-box"><div class="comp-header h-guru">MUTU GURU</div>
        <table id="table-guru"><thead><tr><th>Nama Dokumen</th><th>Aksi</th></tr></thead><tbody id="body-guru"></tbody></table>
    </div>
    <div class="component-box"><div class="comp-header h-manaj">MANAJEMEN SEKOLAH</div>
        <table id="table-manaj"><thead><tr><th>Nama Dokumen</th><th>Aksi</th></tr></thead><tbody id="body-manaj"></tbody></table>
    </div>
</div>

<div id="guideModal">
    <div class="modal-content" id="printableGuide">
        <span onclick="closeGuide()" class="no-print" style="position:absolute; right:20px; top:20px; cursor:pointer; font-weight:bold; color:red;">[ TUTUP ]</span>
        <h2 style="text-align:center; color:var(--navy); margin-bottom:0;">CHECKLIST DOKUMEN AKREDITASI 2026</h2>
        <p style="text-align:center; color:#666; font-size:0.9rem;">Berdasarkan Instrumen IASP Terbaru</p>
        <hr>
        <div class="guide-text">
            <h3 style="color:#ef4444;">1. MUTU LULUSAN</h3>
            <ul>
                <li>Dokumen Kedisiplinan (Tata tertib, Buku Piket, Catatan terlambat)</li>
                <li>Perilaku Religius (Foto ibadah bersama, Perayaan hari besar)</li>
                <li>Tugas/Karya Siswa (Portofolio, Laporan Praktik, P5)</li>
                <li>Prestasi Siswa (Sertifikat lomba akademik/non-akademik)</li>
            </ul>
            <h3 style="color:#f59e0b;">2. PROSES PEMBELAJARAN</h3>
            <ul>
                <li>Perangkat Ajar (RPP/Modul Ajar yang kreatif & lengkap)</li>
                <li>Penilaian (Kisi-kisi, Soal, Analisis Nilai, Remedial)</li>
                <li>Pemanfaatan Sarpras (Foto penggunaan Lab, Perpustakaan, Internet)</li>
                <li>Ekstrakurikuler (Program kerja, Daftar hadir, Foto kegiatan)</li>
            </ul>
            <h3 style="color:#8b5cf6;">3. MUTU GURU</h3>
            <ul>
                <li>Pengembangan Diri (Sertifikat Diklat, Webinar, KKG/MGMP)</li>
                <li>Inovasi Mengajar (Foto/Video media pembelajaran kreatif)</li>
                <li>Supervisi Akademik (Hasil supervisi oleh Kepala Sekolah)</li>
                <li>Refleksi Guru (Dokumen catatan perbaikan mengajar)</li>
            </ul>
            <h3 style="color:#0ea5e9;">4. MANAJEMEN SEKOLAH</h3>
            <ul>
                <li>Dokumen Utama (Visi-Misi, RKAS, Kalender Pendidikan)</li>
                <li>Rapor Pendidikan (Analisis & Tindak Lanjut PBD)</li>
                <li>Kemitraan (MoU dengan Puskesmas, Polisi, Industri, dll)</li>
                <li>Komite Sekolah (Notulen rapat & kerjasama orang tua)</li>
            </ul>
        </div>
        <div class="action-bar no-print" style="margin-top:30px;">
            <button onclick="window.print()" class="btn-action bg-print"><i class="fas fa-print"></i> CETAK / SIMPAN PDF</button>
        </div>
    </div>
</div>

<script>
    // FIREBASE CONFIGURATION
    const firebaseConfig = {
        apiKey: "AIzaSyC...", 
        authDomain: "akreditasi2026-6b216.firebaseapp.com",
        projectId: "akreditasi2026-6b216",
        storageBucket: "akreditasi2026-6b216.appspot.com",
        messagingSenderId: "367375252876",
        appId: "1:367375252876:web:6e1b736798835f8664104d"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function saveData() {
        const name = document.getElementById('docName').value;
        const cat = document.getElementById('docCategory').value;
        const link = document.getElementById('docLink').value;
        if(name && link) {
            db.collection("dokumen").add({
                nama: name, kategori: cat, url: link,
                waktu: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => { 
                alert("Data berhasil tersimpan!"); 
                document.getElementById('docName').value=""; 
                document.getElementById('docLink').value=""; 
            });
        }
    }

    db.collection("dokumen").orderBy("waktu", "desc").onSnapshot((snapshot) => {
        ['mutu-lulusan', 'proses-pembelajaran', 'mutu-guru', 'manajemen-sekolah'].forEach(c => document.getElementById('body-'+c).innerHTML = "");
        snapshot.forEach((doc) => {
            const data = doc.data();
            const row = `<tr><td><strong>${data.nama}</strong></td><td><a href="${data.url}" target="_blank" class="btn-view">Buka Link</a></td></tr>`;
            document.getElementById('body-'+data.kategori).innerHTML += row;
        });
    });

    function downloadExcel() {
        const wb = XLSX.utils.book_new();
        ['mutu-lulusan', 'proses-pembelajaran', 'mutu-guru', 'manajemen-sekolah'].forEach(t => {
            const ws = XLSX.utils.table_to_sheet(document.getElementById('table-'+t));
            XLSX.utils.book_append_sheet(wb, ws, t);
        });
        XLSX.writeFile(wb, "REKAP_AKREDITASI_2026.xlsx");
    }

    function openGuide() { document.getElementById('guideModal').style.display = 'block'; }
    function closeGuide() { document.getElementById('guideModal').style.display = 'none'; }
</script>
</body>
</html>
